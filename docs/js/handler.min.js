import Util from"util.js";import Callout from"callout.js";import Prefs from"prefs.js";import Search from"search.js";const Handler=function(){const e=()=>{let e=prompt("Enter URL for background image");Prefs.set("wallpaper",e),Util.loadWallpaper()},l=()=>{let e=prompt("Enter optional keywords (comma separated words)"),l="https://source.unsplash.com/random/1900x1200?"+encodeURIComponent(e);Prefs.set("wallpaper",l),Util.loadWallpaper()};return{itemClick:e=>{e.preventDefault();let l,t=!1;if("SPAN"===e.target.tagName?(l=$(e.target).closest("li"),$(e.target).hasClass("shortcut")&&(t=!0)):l=$(e.target),e.metaKey||e.altKey)return e.metaKey?Callout.toggleCheckmark(l):e.altKey&&(t?Callout.toggleShortcut(l):Callout.toggleArrow(l)),!1;if($(".callout").removeClass("callout"),$(".persist").removeClass("persist"),"BODY"===e.target.tagName)$(".clicked").removeClass("clicked"),$(".last").removeClass("last"),Callout.setArrow(!1),Callout.setShortcut(!1);else{if(l.hasClass("clicked"))return l.find(".last").length?(Util.clearClicks(),l.parents("li").addClass("clicked"),l.addClass("clicked last")):($(".last").removeClass("last"),l.parents(".clicked").length?(l.removeClass("clicked"),l.siblings(".clicked").removeClass("clicked"),l.parents(".clicked").first().addClass("last")):$(".clicked").removeClass("clicked"),Callout.setArrow(!1),Callout.setShortcut(!1)),!1;Callout.setArrow(!1),Callout.setShortcut(!1),$("li.clicked").removeClass("clicked"),$(".last").removeClass("last"),l.parents("li").addClass("clicked"),e.altKey&&Callout.setArrow(!0,l),l.addClass("clicked last"),"dblclick"===e.type&&(l.addClass("callout"),e.shiftKey&&l.parents(".clicked").addClass("callout"))}return!1},controlsClick:t=>{switch(t.preventDefault(),t.target.id){case"darkModeToggle":Util.toggleDarkMode();break;case"exposeToggle":Util.toggleExpose();break;case"backgroundToggle":Util.toggleBG();break;case"chooseWallpaper":e();break;case"randomWallpaper":l();break;case"resetWallpaper":Util.setWallpaper(!1);break;case"arrowStyle":Callout.toggleArrowStyle();break;case"screenshot":Util.screenshot(t);break;case"commandshell":Util.terminal(t);break;default:throw"Element ID unrecognized"}return!1},liveSearch:e=>{let l=$(".helpsearch input"),t=l.val(),a=!1;if("Escape"===e.code)return e.preventDefault(),l.val("").blur(),Util.clearClicks(!0),!0;if("Enter"!==e.code&&"Return"!==e.code||(e.preventDefault(),$(".persist").removeClass("persist"),a=!0),t.length<2)return Util.clearClicks(!1),!0;let r=Search.find(t);return r?(Util.clearClicks(!1),r.parents("li")&&r.parents("li").addClass("clicked"),r.addClass("clicked last"),a&&(l.blur(),r.get(0).scrollIntoView({behavior:"smooth",block:"end",inline:"center"}))):Util.clearClicks(!1),!0},focusSearch:e=>{e.preventDefault(),$("li.callout").removeClass("callout"),$(".clicked").removeClass("clicked"),Util.clearClicks();let l=$(".helpsearch").first();return l.parents("li").addClass("clicked persist"),l.get(0).scrollIntoView({behavior:"smooth",block:"end",inline:"end"}),$("input",l).focus(),!1}}}();export default Handler;