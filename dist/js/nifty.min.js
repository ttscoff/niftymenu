"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Prefs=function(){var e={set:function(e,t){localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)},getBool:function(t){var l=e.get(t);return Number(l)?Boolean(Number(l)):!!/(y(es)?|true)/i.test(l)}};return e}(),Nifty=function(){var e=function(e){if(/^\s*$/.test(e))return null;var t,l=$("ul ul li"),s=[new RegExp("^"+e,"i"),new RegExp("\\b"+e,"i"),new RegExp(e,"i")],i=function(e){if((t=l.filter(function(t,l){var i=l.innerText.split("\n")[0].toLowerCase();return!!s[e].test(i)})).length>0)return{v:t.first()}};for(var r in s){var o=i(r);if("object"===_typeof(o))return o.v}return null},t=function(){return o.menuItemTitles.length>0?o.menuItemTitles:(o.menuItemTitles=[],$("ul ul li").each(function(e,t){o.menuItemTitles.push($(t).text().split(/\n/)[0])}),o.menuItemTitles)},l=function(){var e=$("body");e.hasClass("bgimage")?(e.removeClass("bgimage"),Prefs.set("bgimage",0)):(e.addClass("bgimage"),Prefs.set("bgimage",1))},s=function(){var e=$("body");$("body").hasClass("dark")?(e.removeClass("dark"),Prefs.set("darkmode",0)):(e.addClass("dark"),Prefs.set("darkmode",1))},i=function(){var e=$("body");e.hasClass("expose")?(e.removeClass("expose"),Prefs.set("expose",0)):(e.addClass("expose"),Prefs.set("expose",1))},r=function(e){$("li.lastclicked").removeClass("lastclicked"),$(".clicked").removeClass("clicked"),e&&$(".persist").removeClass("persist")},o={menuItemTitles:[],init:function(){t()},click:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.util.clearClicks(!0),e&&!/^\s*$/.test(e)){var t=o.fuzzyFind(e);t&&(t.click(),t.get(0).scrollIntoView({behavior:"auto",block:"end",inline:"center"}))}else o.util.clearClicks(!0)},dblClick:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.util.clearClicks(!0),e&&!/^\s*$/.test(e)){var t=o.fuzzyFind(e);t&&(t.dblclick(),t.get(0).scrollIntoView({behavior:"auto",block:"end",inline:"center"}))}else o.util.clearClicks(!0)},fuzzyFind:e,handlers:{itemClick:function(e){e.preventDefault();var t=$(e.target);if($("li.lastclicked").removeClass("lastclicked"),$(".persist").removeClass("persist"),"BODY"===e.target.tagName)$(".clicked").removeClass("clicked");else{if(t.hasClass("clicked"))return $(".clicked").removeClass("clicked"),!1;$("li.clicked").removeClass("clicked"),t.parents("li").addClass("clicked"),t.addClass("clicked"),"dblclick"===e.type&&t.addClass("lastclicked")}return!1},controlsClick:function(e){switch(e.preventDefault(),e.target.id){case"darkModeToggle":s();break;case"exposeToggle":i();break;case"backgroundToggle":l();break;default:console.info("Element ID unrecognized")}return!1},liveSearch:function(l){var s,i,o,n=$(".helpsearch input"),a=n.val(),c=!1;if("Escape"===l.code)return l.preventDefault(),n.val("").blur(),r(!0),!0;if("Enter"!==l.code&&"Return"!==l.code||(l.preventDefault(),$(".persist").removeClass("persist"),c=!0),a.length<2)return r(!1),!0;s=t(),o=(i=fuzzysort.go(a,s)).length?i[0].target:a;var u=e(o);return u?(r(!1),u.parents("li").addClass("clicked"),u.addClass("clicked"),c&&(n.blur(),u.get(0).scrollIntoView({behavior:"smooth",block:"end",inline:"center"}))):r(!1),!0}},util:{setDarkMode:function(e){var t=$("body");e?t.addClass("dark"):t.removeClass("dark")},toggleDarkMode:s,setExpose:function(e){var t=$("body");e?t.addClass("expose"):t.removeClass("expose")},toggleExpose:i,setBG:function(e){var t=$("body");e?t.addClass("bgimage"):t.removeClass("bgimage")},toggleBG:l,focusSearch:function(e){e.preventDefault(),$("li.lastclicked").removeClass("lastclicked"),$(".clicked").removeClass("clicked");var t=$(".helpsearch").first();return t.parents("li").addClass("clicked persist"),t.get(0).scrollIntoView({behavior:"smooth",block:"end",inline:"end"}),$("input",t).focus(),!1},clearClicks:r}};return o}();$(function(){Nifty.init(),Prefs.getBool("darkmode")&&Nifty.util.toggleDarkMode(),Prefs.getBool("expose")&&Nifty.util.toggleExpose(),Prefs.getBool("bgimage")&&Nifty.util.toggleBG(),$("body,li").on("click dblclick",Nifty.handlers.itemClick),$("span",".controls").on("click",Nifty.handlers.controlsClick),$(".helpsearch input").on("keydown",Nifty.handlers.liveSearch),$(".helpsearch").on("click",Nifty.util.focusSearch),$(".helpsearch").on("blur",function(){$(".persist").removeClass("persist")}),Mousetrap.bind("shift+/",Nifty.util.focusSearch),Mousetrap.bind("shift+d",Nifty.util.toggleDarkMode),Mousetrap.bind("shift+e",Nifty.util.toggleExpose)});